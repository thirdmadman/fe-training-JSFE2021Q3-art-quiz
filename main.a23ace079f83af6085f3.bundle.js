!function(){"use strict";var e={};function t(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function n(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}e.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),function(){var t;e.g.importScripts&&(t=e.g.location+"");var n=e.g.document;if(!t&&n&&(n.currentScript&&(t=n.currentScript.src),!t)){var r=n.getElementsByTagName("script");r.length&&(t=r[r.length-1].src)}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),e.p=t}();var r=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),n(this,"gameDifficulty",null),n(this,"soundLevel",null),n(this,"language",null),n(this,"userName",null),n(this,"auth",null)}var r,a,i;return r=e,(a=[{key:"getUserName",value:function(){return this.userName}},{key:"setUserName",value:function(e){this.userName=e}},{key:"getAuth",value:function(){return this.auth}},{key:"setAuth",value:function(e){this.auth=e}},{key:"getGameDifficulty",value:function(){return this.gameDifficulty}},{key:"setGameDifficulty",value:function(t){var n=t;n<0&&(n=e.GameDifficulty.easy),n>3&&(n=e.GameDifficulty.nightmare),this.gameDifficulty=n}},{key:"getSoundLevel",value:function(){return this.soundLevel}},{key:"setSoundLevel",value:function(e){var t=e;t<0&&(t=0),t>100&&(t=100),this.soundLevel=t}},{key:"getLanguage",value:function(){return this.language}},{key:"setLanguage",value:function(e){this.language=e}}])&&t(r.prototype,a),i&&t(r,i),Object.defineProperty(r,"prototype",{writable:!1}),e}();function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n(r,"GameDifficulty",{easy:0,normal:1,hard:2,nightmare:3});var o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"setCurrentPath",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e.path=t,window.location.hash=t,e.callbacksArray.forEach((function(e){e(t,n)}))}},{key:"getCurrentPath",value:function(){return e.path}},{key:"getRealCurrentPath",value:function(){return window.location.hash.slice(1)}},{key:"addPathChangeListener",value:function(t){e.callbacksArray.push(t)}}],(n=null)&&a(t.prototype,n),r&&a(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}i(o,"data",{}),i(o,"path",null),i(o,"callbacksArray",[]);var l=function(){function e(){var t,n,r,a=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),r=[],(n="routes")in(t=this)?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,window.addEventListener("hashchange",(function(){window.location.hash.slice(1)!==o.getCurrentPath()&&o.setCurrentPath(window.location.hash.slice(1))}),!1),o.addPathChangeListener((function(e,t){a.resolve(e,t)}))}var t,n,r;return t=e,(n=[{key:"resolve",value:function(e,t){this.routes.forEach((function(n){n.path==="/".concat(e.split("/")[1])&&n.controller.resolve(e.replace(n.path,""),t)}))}},{key:"addRoute",value:function(e,t){this.routes.push({path:e,controller:t})}}])&&s(t.prototype,n),r&&s(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var c=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.data=t,this.isHidden=!1,this.rootEl=document.createElement("div"),this.rootEl.classList.add("sidebar"),this.sidebarContainer=document.createElement("div"),this.sidebarContainer.classList.add("sidebar__container"),this.buttonClose=document.createElement("div"),this.buttonClose.classList.add("button-close"),this.sidebarVerticalSeparator=document.createElement("div"),this.sidebarVerticalSeparator.classList.add("sidebar__vertical-separator"),this.mainMenuList=document.createElement("div"),this.mainMenuList.classList.add("main-menu__list"),this.fastLangSwitch=document.createElement("div"),this.fastLangSwitch.classList.add("main-menu__fast-lang-sw","fast-lang-sw"),this.rootEl.append(this.sidebarContainer)}var t,n,r;return t=e,(n=[{key:"setData",value:function(e){var t=this;this.data=e,this.sidebarContainer.innerHTML="",this.mainMenu=document.createElement("div"),this.mainMenu.classList.add("sidebar__main-menu","main-menu"),this.mainMenuList.innerHTML="",this.data.menu.forEach((function(n){var r=document.createElement("button");r.classList.add("main-menu__list-button"),r.textContent=n.text,r.onclick=function(){t.hide(),n.action(n.path)},e.currentPath&&e.currentPath===n.path&&(r.classList.add("main-menu__list-button_current"),r.onclick=null),t.mainMenuList.append(r)})),this.sidebarVerticalSeparator.innerHTML="";var n=document.createElement("span");n.innerText=this.data.separatorText;for(var r=0;r<10;r+=1)this.sidebarVerticalSeparator.append(n.cloneNode(!0));this.fastLangSwitch.innerHTML="",this.data.fastLangSw.forEach((function(e){var n=document.createElement("button");n.classList.add("fast-lang-sw__lang-button"),n.textContent=e.text,n.onclick=e.action,t.fastLangSwitch.append(n)})),this.mainMenu.append(this.buttonClose),this.mainMenu.append(this.mainMenuList),this.mainMenu.append(this.fastLangSwitch),this.sidebarContainer.appendChild(this.sidebarVerticalSeparator),this.sidebarContainer.appendChild(this.mainMenu)}},{key:"render",value:function(){return this.rootEl}},{key:"hide",value:function(){this.rootEl.classList.add("sidebar_hidden"),this.isHidden=!0}},{key:"show",value:function(){this.rootEl.classList.remove("sidebar_hidden"),this.isHidden=!1}}])&&u(t.prototype,n),r&&u(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function d(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var h=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.dataPlaceholder={title:"Art-Quiz.",isSmall:!1},this.rootEl=document.createElement("div"),this.rootEl.classList.add("top-bar"),this.menuButton=document.createElement("div"),this.menuButton.classList.add("burger-menu"),this.title=document.createElement("div"),this.title.classList.add("top-bar__title"),this.rootEl.appendChild(this.menuButton),this.rootEl.appendChild(this.title)}var t,n,r;return t=e,(n=[{key:"setData",value:function(e){e&&Object.keys(e).length>=1?this.data=e:this.data=this.dataPlaceholder,this.title.textContent=this.data.title,this.data.isSmall&&this.rootEl.classList.add("top-bar_s")}},{key:"render",value:function(){return this.rootEl}}])&&d(t.prototype,n),r&&d(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function f(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function p(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var m=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"getDefaultStaticSquareImagesPath",value:function(){return e.defaultStaticSquareImagesPath}},{key:"getDefaultStaticFullImagesPath",value:function(){return e.defaultStaticFullImagesPath}},{key:"getDefaultStaticJsonSrcPath",value:function(){return e.defaultStaticJsonSrcPath}},{key:"getQuestionsPerLevel",value:function(){return e.questionsPerLevel}}],(n=null)&&f(t.prototype,n),r&&f(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function v(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function g(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}p(m,"questionsPerLevel",10),p(m,"defaultStaticSquareImagesPath","static/img/jpg/square/"),p(m,"defaultStaticFullImagesPath","static/img/jpg/full/"),p(m,"defaultStaticJsonSrcPath","static/json/imagesTranslated.json");var y=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"getData",value:function(){return new Promise((function(t){null!==e.cachedData&&e.isCacheActive?t(e.cachedData):e.isEmpty().then((function(n){if(!n){var r=localStorage.getItem(e.localStorageItemName),a=JSON.parse(r),i=Object.keys(a).length>0?a:null;if(null!=i)return e.cachedData=i,void t(i)}var o=e.generateData();e.setData(o),t(o)}))}))}},{key:"destroy",value:function(){localStorage.removeItem(e.localStorageItemName)}},{key:"isEmpty",value:function(){return new Promise((function(t){var n=localStorage.getItem(e.localStorageItemName);t(!(n&&"{"===n[0]))}))}},{key:"setData",value:function(t){e.cachedData=t,localStorage.setItem(e.localStorageItemName,JSON.stringify(t))}},{key:"generateData",value:function(){var t=function(e,t){var n=Math.ceil(e),r=Math.floor(t);return Math.floor(Math.random()*(r-n+1))+n};localStorage.removeItem(e.localStorageItemName);var n=0,r=0,a=0,i=1,o=m.getDefaultStaticSquareImagesPath(),s=m.getQuestionsPerLevel(),l={settings:{gameDifficulty:0,soundLevel:50,language:0,userName:"UserName",Auth:""},gameDB:{level:[],question:[],answer:[],userAnswer:[]}};return e.srcData.data.forEach((function(e,u,c){u%s==0&&(u>=s&&(n+=1),l.gameDB.level.push({id:n,imageSrc:"".concat(o).concat(e.imageId,".jpg"),isLocked:n>=2,text:""})),l.gameDB.question.push({id:r,levelId:n,number:i,questionType:t(1,2),correctAnswerId:a,imageSrc:"".concat(o).concat(e.imageId,".jpg"),text:""}),l.gameDB.answer.push({id:a,questionId:r,imageSrc:"".concat(o).concat(e.imageId,".jpg"),text:"",name:e.name,author:e.author,year:e.year}),a+=1;for(var d=[],h=[],f=function(e){for(var n=t(0,c.length-1);-1!==h.findIndex((function(e){return e===n}));)n=t(0,c.length-1);h.push(n),d.push({id:a,questionId:r,imageSrc:"".concat(o).concat(c[n].imageId,".jpg"),text:"",name:c[n].name,author:c[n].author,year:c[n].year}),a+=1},p=0;p<3;p+=1)f();d.forEach((function(e){return l.gameDB.answer.push(e)})),r+=1,i=i<s?i+=1:1})),l}}],(n=null)&&v(t.prototype,n),r&&v(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function b(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function w(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function E(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}g(y,"localStorageItemName","art-quiz-game-data"),g(y,"srcData",null),g(y,"cachedData",null),g(y,"isCacheActive",!0);var L=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,a;return t=e,a=[{key:"dataToModel",value:function(e){var t=new r;return t.setGameDifficulty(e.gameDifficulty),t.setSoundLevel(e.soundLevel),t.setLanguage(e.language),t.setUserName(e.userName),t.setAuth(e.Auth),t}},{key:"getSettings",value:function(){return new Promise((function(t){y.getData().then((function(n){var r=n.settings;t(e.dataToModel(r))}))}))}},{key:"setSettings",value:function(t){return new Promise((function(n){y.getData().then((function(r){var a=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?b(Object(n),!0).forEach((function(t){w(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):b(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},r),i=e.modelToData(t);a.settings=i,n(y.setData(a))}))}))}},{key:"modelToData",value:function(e){return{gameDifficulty:e.getGameDifficulty(),soundLevel:e.getSoundLevel(),language:e.getLanguage(),userName:e.getUserName(),auth:e.getAuth()}}}],(n=null)&&E(t.prototype,n),a&&E(t,a),Object.defineProperty(t,"prototype",{writable:!1}),e}();function k(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function T(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var P=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"getLocale",value:function(t){return e.locales[e.currentLocale][t]}},{key:"setCurrentLocale",value:function(t){e.currentLocale=t,L.getSettings().then((function(e){console.error(t);var n=e;e.setLanguage(t),L.setSettings(n)}))}},{key:"getCurrentLocale",value:function(){return e.currentLocale}}],(n=null)&&k(t.prototype,n),r&&k(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function C(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}T(P,"currentLocale",0),T(P,"locales",[{localeName:"eng",title:"ArtQuiz",levelTitle:"Level",settingsTitle:"Settings",levelsTitle:"Levels",scoreTitle:"Score",aboutTitle:"About",sidebarMotto:"CREATE TEST DEPLOY BE SMART",levelLockedTitle:"Locked",levelStatsTitle:"Done",gamePaused:"Paused",gameQuestionType1:"Who wrote this picture?",gameQuestionType2:"Which one is written by",gameSelectTitle:"Select",gameCancelTitle:"Cancel",gameAnswerCorrect:"Correct",gameAnswerIncorrect:"Incorrect",gameNextButtonTitle:"Next",gamePictureNameTitle:"This is:",gameMadeByTitle:"Made by:",gameYearTitle:"Year of creation:",levelResults:"Results",gameResultNoAnswer:"No answer",gameResultBackToLevels:"Back to levels",gameResultLevelComplete:"Level complete",gameResultTryAgain:"Try again to unlock next level",gameResultGoodJob:"Good job!"},{localeName:"ru",title:"ArtQuiz",levelTitle:"Уровень",settingsTitle:"Настройки",levelsTitle:"Уровни",scoreTitle:"Счёт",aboutTitle:"О игре",sidebarMotto:"СОЗДАВАЙ ТЕСТИРУЙ РАЗВОРАЧИВАЙ БУДЬ УМЁН",levelLockedTitle:"Заблокировано",levelStatsTitle:"Отвечено",gamePaused:"Пауза",gameQuestionType1:"Кто написал эту картину?",gameQuestionType2:"Какую из картин написал автор",gameSelectTitle:"Выбрать",gameCancelTitle:"Отмена",gameAnswerCorrect:"Правильно",gameAnswerIncorrect:"Неправильно",gameNextButtonTitle:"Далее",gamePictureNameTitle:"Картина называется:",gameMadeByTitle:"Написана автором:",gameYearTitle:"Год создания:",levelResults:"Результаты",gameResultNoAnswer:"Неотвечено",gameResultBackToLevels:"Назад к уровням",gameResultLevelComplete:"Уровень завершён",gameResultTryAgain:"Попробуйте ещё раз, чтобы открыть следующий уровень",gameResultGoodJob:"Хорошая работа!"}]);var I=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.dataPlaceholder={id:-1,imgSrc:"static/img/jpg/square/0.jpg",isLocked:!1,text:""},this.rootEl=document.createElement("div"),this.rootEl.classList.add("level-card"),this.rootEl.classList.add("level-list__card"),this.imageContainer=document.createElement("div"),this.imageContainer.classList.add("level-card__image"),this.imageEl=document.createElement("img"),this.imageContainer.append(this.imageEl),this.levelText=document.createElement("div"),this.levelText.classList.add("level-card__text"),this.levelTitle=document.createElement("div"),this.levelTitle.classList.add("level-card__level-name"),this.levelStats=document.createElement("div"),this.levelStats.classList.add("level-card__level-stats"),this.levelText.append(this.levelTitle),this.levelText.append(this.levelStats),this.rootEl.append(this.imageContainer),this.rootEl.append(this.levelText),this.setData(t)}var t,n,r;return t=e,(n=[{key:"setData",value:function(e){e&&Object.keys(e).length>=1&&(this.data=e,this.imageEl.src=this.data.getImageSrc(),this.imageEl.alt="".concat(P.getLocale("levelTitle")," ").concat(this.data.getId()),this.levelTitle.textContent="".concat(P.getLocale("levelTitle")," ").concat(this.data.getId()),this.levelStats.textContent=this.data.getIsLocked()?P.getLocale("levelLockedTitle"):"".concat(P.getLocale("levelStatsTitle")," ").concat(this.data.getQuestionsAnsweredNumber(),"/").concat(this.data.getQuestionsNumber()),this.data.getIsLocked()&&this.rootEl.classList.add("level-card_locked"))}},{key:"render",value:function(){return this.rootEl}}])&&C(t.prototype,n),r&&C(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function S(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var O=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.rootEl=document.createElement("div"),this.rootEl.classList.add("level-list"),this.levelsList=[]}var t,n,r;return t=e,(n=[{key:"setData",value:function(e){var t=this;e&&(this.levelsList=[],this.rootEl.innerHTML="",e.levelsList.forEach((function(e){var n=new I;n.setData(e),t.levelsList.push(n),e.getIsLocked()||(n.render().onclick=function(){o.setCurrentPath("/game/level/".concat(e.getId()))}),t.rootEl.append(n.render())})))}},{key:"render",value:function(){return this.rootEl}}])&&S(t.prototype,n),r&&S(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function A(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var j=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.rootEl=document.createElement("div"),this.rootEl.classList.add("questions-numbers-list")}var t,n,r;return t=e,(n=[{key:"setData",value:function(e){var t=this,n=e.levelModel,r=e.questionNumber;this.rootEl.innerHTML="",n.getQuestions().forEach((function(e,n){var a=document.createElement("div");a.classList.add("questions-numbers-list__item");var i=document.createElement("p");i.innerText=e.getNumber(),e.getUserAnswer()&&(e.isUserAnswerCorrect()?a.classList.add("questions-numbers-list__item_correct"):a.classList.add("questions-numbers-list__item_incorrect")),r>=0&&n===r-1&&a.classList.add("questions-numbers-list__item_active"),a.append(i),t.rootEl.append(a)}))}},{key:"render",value:function(){return this.rootEl}}])&&A(t.prototype,n),r&&A(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function _(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var D=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.rootEl=document.createElement("div"),this.rootEl.classList.add("score-card")}var t,n,r;return t=e,(n=[{key:"setData",value:function(e){var t=document.createElement("div");t.classList.add("score-card__wrapper");var n=document.createElement("div");n.classList.add("score-card__text"),n.innerText="".concat(e.getQuestionsAnsweredNumber(),"/").concat(e.getQuestionsNumber());var r=document.createElement("div");r.classList.add("score-card__title"),r.innerText="".concat(P.getLocale("levelTitle")," ").concat(e.getId());var a=new j;a.setData({levelModel:e}),e.getIsLocked()?this.rootEl.classList.add("score-card_locked"):this.rootEl.onclick=function(){return o.setCurrentPath("/game/level/".concat(e.getId(),"/result"))},t.append(n,r,a.render()),this.rootEl.style.backgroundImage="url('".concat(e.getImageSrc(),"')"),this.rootEl.append(t)}},{key:"render",value:function(){return this.rootEl}}])&&_(t.prototype,n),r&&_(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function q(e){return function(e){if(Array.isArray(e))return x(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return x(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return x(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function x(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function B(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var N=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.rootEl=document.createElement("div"),this.rootEl.classList.add("score-cards-container")}var t,n,r;return t=e,(n=[{key:"setData",value:function(e){var t,n=e.levelsList.map((function(e){var t=new D;return t.setData(e),t.render()}));(t=this.rootEl).append.apply(t,q(n))}},{key:"render",value:function(){return this.rootEl}}])&&B(t.prototype,n),r&&B(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function M(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Q=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.rootEl=document.createElement("div"),this.rootEl.classList.add("score-list")}var t,n,r;return t=e,(n=[{key:"setData",value:function(e){this.rootEl.innerHTML="";var t=new N;t.setData(e),this.rootEl.append(t.render())}},{key:"render",value:function(){return this.rootEl}}])&&M(t.prototype,n),r&&M(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function R(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var U=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.rootEl=document.createElement("div"),this.rootEl.classList.add("settings"),this.rootEl.innerText="Settings"}var t,n,r;return t=e,(n=[{key:"render",value:function(){return this.rootEl}}])&&R(t.prototype,n),r&&R(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function H(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var V=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.rootEl=document.createElement("div"),this.rootEl.classList.add("about"),this.rootEl.innerText="About"}var t,n,r;return t=e,(n=[{key:"render",value:function(){return this.rootEl}}])&&H(t.prototype,n),r&&H(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function G(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function J(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Y=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),J(this,"id",-1),J(this,"imageSrc",null),J(this,"text",null),J(this,"isLocked",!0),J(this,"questions",null),this.id=t}var t,n,r;return t=e,(n=[{key:"getImageSrc",value:function(){return this.imageSrc}},{key:"setImageSrc",value:function(e){this.imageSrc=e}},{key:"getId",value:function(){return this.id}},{key:"getQuestions",value:function(){return this.questions}},{key:"setQuestions",value:function(e){this.questions=e}},{key:"getText",value:function(){return this.text}},{key:"setText",value:function(e){this.text=e}},{key:"getIsLocked",value:function(){return this.isLocked}},{key:"setIsLocked",value:function(e){this.isLocked=e}},{key:"getQuestionsNumber",value:function(){return this.questions.length}},{key:"getQuestionsAnsweredNumber",value:function(){return this.questions.filter((function(e){return null!==e.userAnswer})).length}},{key:"getNumberOfAnsweredQuestions",value:function(){return this.questions.map((function(e){return e.getUserAnswer()})).reduce((function(e,t){return null!==t?e+1:e}),0)}},{key:"getNumberOfCorrectAnsweredQuestions",value:function(){return this.questions.map((function(e){return e.isUserAnswerCorrect()})).filter((function(e){return null!==e&&e})).length}}])&&G(t.prototype,n),r&&G(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function W(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function F(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var $=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),F(this,"id",-1),F(this,"levelId",-1),F(this,"number",void 0),F(this,"questionType",null),F(this,"answers",null),F(this,"correctAnswerId",-1),F(this,"userAnswer",null),F(this,"imageSrc",null),F(this,"text",null),this.id=t,this.levelId=n}var t,n,r;return t=e,(n=[{key:"getLevelId",value:function(){return this.levelId}},{key:"setLevelId",value:function(e){this.levelId=e}},{key:"getId",value:function(){return this.id}},{key:"getNumber",value:function(){return this.number}},{key:"setNumber",value:function(e){this.number=e}},{key:"getImageSrc",value:function(){return this.imageSrc}},{key:"setImageSrc",value:function(e){this.imageSrc=e}},{key:"getText",value:function(){return this.text}},{key:"setText",value:function(e){this.text=e}},{key:"getQuestionType",value:function(){return this.questionType}},{key:"setQuestionType",value:function(e){this.questionType=e}},{key:"getAnswers",value:function(){return this.answers}},{key:"setAnswers",value:function(e){this.answers=e}},{key:"getCorrectAnswerId",value:function(){return this.correctAnswerId}},{key:"setCorrectAnswerId",value:function(e){this.correctAnswerId=e}},{key:"getUserAnswer",value:function(){return this.userAnswer}},{key:"setUserAnswer",value:function(e){this.userAnswer=e}},{key:"getCorrectAnswer",value:function(){var e=this;return this.answers.filter((function(t){return t.getId()===e.correctAnswerId}))[0]}},{key:"isUserAnswerCorrect",value:function(){return this.userAnswer?null!=this.userAnswer.getAnswerId()&&this.userAnswer.getAnswerId()===this.correctAnswerId:null}}])&&W(t.prototype,n),r&&W(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function z(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function K(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}F($,"QuestionTypes",{WhoIs:1,WhichIs:2});var X=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),K(this,"id",-1),K(this,"questionId",-1),K(this,"imageSrc",null),K(this,"author",null),K(this,"name",null),K(this,"year",null),this.id=t}var t,n,r;return t=e,(n=[{key:"getQuestionId",value:function(){return this.questionId}},{key:"setQuestionId",value:function(e){this.questionId=e}},{key:"getId",value:function(){return this.id}},{key:"getImageSrc",value:function(){return this.imageSrc}},{key:"setImageSrc",value:function(e){this.imageSrc=e}},{key:"getAuthor",value:function(){return this.author}},{key:"setAuthor",value:function(e){this.author=e}},{key:"getName",value:function(){return this.name}},{key:"setName",value:function(e){this.name=e}},{key:"getYear",value:function(){return this.year}},{key:"setYear",value:function(e){this.year=e}}])&&z(t.prototype,n),r&&z(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function Z(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var ee=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"dataToModel",value:function(e){var t=new X(e.id);return t.setQuestionId(e.questionId),t.setImageSrc(e.imageSrc),t.setName(e.name),t.setAuthor(e.author),t.setYear(e.year),t}},{key:"getAllByQuestionId",value:function(t){return new Promise((function(n){y.getData().then((function(r){var a=r.gameDB.answer.filter((function(e){return e.questionId===t}));n(a.map((function(t){return e.dataToModel(t)})))}))}))}}],(n=null)&&Z(t.prototype,n),r&&Z(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function te(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ne(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var re=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),ne(this,"id",-1),ne(this,"answerId",-1),ne(this,"questionId",-1),ne(this,"thinkingTime",null),ne(this,"answerDate",null),this.id=t}var t,n,r;return t=e,(n=[{key:"getId",value:function(){return this.id}},{key:"getQuestionId",value:function(){return this.questionId}},{key:"setQuestionId",value:function(e){this.questionId=e}},{key:"getAnswerId",value:function(){return this.answerId}},{key:"setAnswerId",value:function(e){this.answerId=e}},{key:"getAnswerDate",value:function(){return this.answerDate}},{key:"setAnswerDate",value:function(e){this.answerDate=e}},{key:"getThinkingTime",value:function(){return this.thinkingTime}},{key:"setThinkingTime",value:function(e){this.thinkingTime=e}}])&&te(t.prototype,n),r&&te(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function ae(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ie(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function oe(e){return function(e){if(Array.isArray(e))return se(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return se(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return se(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function se(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function le(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var ue=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"dataToModel",value:function(e){var t=new re(e.id);return t.setAnswerId(e.answerId),t.setQuestionId(e.questionId),t.setThinkingTime(e.thinkingTime),t.setAnswerDate(e.answerDate),t}},{key:"getByQuestionId",value:function(t){return new Promise((function(n){y.getData().then((function(r){var a=r.gameDB.userAnswer.filter((function(e){return e.questionId===t}));a&&a.length>0&&n(a.map((function(t){return e.dataToModel(t)}))[0]),n(null)}))}))}},{key:"setUserAnswer",value:function(t){return new Promise((function(n){y.getData().then((function(r){var a=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ae(Object(n),!0).forEach((function(t){ie(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ae(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},r),i=e.modelToData(t);e.getByQuestionId(t.getQuestionId()).then((function(e){if(e){i.id=e.getId();var t=a.gameDB.userAnswer.findIndex((function(t){return t.id===e.getId()}));a.gameDB.userAnswer[t]=i}else i.id=function(e){if(!e||0===e.length)return-1;var t=e.map((function(e){return e.id}));return Math.max.apply(Math,oe(t))}(a.gameDB.userAnswer)+1,a.gameDB.userAnswer.push(i);n(y.setData(a))}))}))}))}},{key:"modelToData",value:function(e){return{id:e.getId(),questionId:e.getQuestionId(),answerId:e.getAnswerId(),thinkingTime:e.getThinkingTime(),answerDate:e.getAnswerDate()}}}],(n=null)&&le(t.prototype,n),r&&le(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function ce(e){return function(e){if(Array.isArray(e))return de(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return de(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return de(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function de(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function he(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var fe=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"dataToModel",value:function(e){var t=new $(e.id);t.setNumber(e.number),t.setLevelId(e.levelId),t.setQuestionType(e.questionType),t.setCorrectAnswerId(e.correctAnswerId),t.setImageSrc(e.imageSrc),t.setText(e.text);var n=new Promise((function(n){ee.getAllByQuestionId(e.id).then((function(e){n(t.setAnswers(e))}))})),r=new Promise((function(n){ue.getByQuestionId(e.id).then((function(e){n(t.setUserAnswer(e))}))}));return new Promise((function(e){Promise.all([n,r]).then(e(t))}))}},{key:"getAllByLevelId",value:function(t){return new Promise((function(n){y.getData().then((function(r){var a=r.gameDB.question.filter((function(e){return e.levelId===t}));Promise.all(a.map((function(t){return e.dataToModel(t)}))).then((function(e){return n(e)}))}))}))}},{key:"getLastWithAnswerByLevelId",value:function(t){return new Promise((function(n){e.getAllByLevelId(t).then((function(e){var t=e.filter((function(e){return e.getUserAnswer()})),r=t.map((function(e){return e.getNumber()})),a=Math.max.apply(Math,ce(r)),i=t.filter((function(e){return e.getNumber()===a}))[0];n(i)}))}))}}],(n=null)&&he(t.prototype,n),r&&he(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function pe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function me(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ve(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var ge=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"dataToModel",value:function(e){return new Promise((function(t){var n=new Y(e.id);n.setImageSrc(e.imageSrc),n.setText(e.text),n.setIsLocked(e.isLocked),fe.getAllByLevelId(e.id).then((function(e){n.setQuestions(e),t(n)}))}))}},{key:"getAll",value:function(){return new Promise((function(t){y.getData().then((function(n){var r=n.gameDB.level.map((function(t){return e.dataToModel(t)}));Promise.all(r).then((function(e){return t(e)}))}))}))}},{key:"getById",value:function(t){return new Promise((function(n){y.getData().then((function(r){var a=null;(a=r.gameDB.level.filter((function(e){return e.id===parseInt(t,10)})))&&a.length>0&&a.map((function(t){return e.dataToModel(t)}))[0].then((function(e){return n(e)}))}))}))}},{key:"setLevelIsLockeById",value:function(e,t){return new Promise((function(n){y.getData().then((function(r){var a=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?pe(Object(n),!0).forEach((function(t){me(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):pe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},r),i=a.gameDB.level;if(i&&i.length>0){var o=a.gameDB.level.findIndex((function(t){return t.id===e}));a.gameDB.level[o].isLocked=t,n(y.setData(a))}}))}))}}],(n=null)&&ve(t.prototype,n),r&&ve(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function ye(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var be=function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.parentElement=t,this.rootEl=document.createElement("div"),this.rootEl.classList.add("container"),this.sidebar=new c,this.generateSidebarData(),this.page=document.createElement("div"),this.page.classList.add("main-page"),this.topBar=new h,this.topBar.setData({title:"".concat(P.getLocale("levelsTitle"),".")}),this.topBarEl=this.topBar.render(),this.levelsListView=new O,this.scoreView=new Q,this.settingsView=new U,this.aboutView=new V,this.currentView=document.createElement("div"),this.page.append(this.topBarEl),this.page.append(this.currentView),this.rootEl.append(this.sidebar.render()),this.sidebar.hide(),this.rootEl.append(this.page),this.sidebar.buttonClose.onclick=function(){n.sidebar.hide()},this.topBar.menuButton.onclick=function(){n.sidebar.show()}}var t,n,r;return t=e,(n=[{key:"generateSidebarData",value:function(e){var t={separatorText:P.getLocale("sidebarMotto"),currentPath:"/main".concat(e),menu:[{text:P.getLocale("levelsTitle"),path:"/main/levels",action:o.setCurrentPath},{text:P.getLocale("scoreTitle"),path:"/main/score",action:o.setCurrentPath},{text:P.getLocale("settingsTitle"),path:"/main/settings",action:o.setCurrentPath},{text:P.getLocale("aboutTitle"),path:"/main/about",action:o.setCurrentPath}],fastLangSw:[{text:"eng",action:function(){P.setCurrentLocale(0),o.setCurrentPath(o.getCurrentPath())}},{text:"ru",action:function(){P.setCurrentLocale(1),o.setCurrentPath(o.getCurrentPath())}}]};this.sidebar.setData(t)}},{key:"rewriteView",value:function(e){this.currentView.innerHTML="",this.currentView.append(e)}},{key:"viewLevels",value:function(){var e=this;ge.getAll().then((function(t){e.levelsListView.setData({levelsList:t})})),this.rewriteView(this.levelsListView.render()),this.topBar.setData({title:"".concat(P.getLocale("levelsTitle"),".")})}},{key:"viewSettings",value:function(){this.rewriteView(this.settingsView.render()),this.topBar.setData({title:"".concat(P.getLocale("settingsTitle"),".")})}},{key:"viewScore",value:function(){var e=this;ge.getAll().then((function(t){return e.scoreView.setData({levelsList:t})})),this.rewriteView(this.scoreView.render()),this.topBar.setData({title:"".concat(P.getLocale("scoreTitle"),".")})}},{key:"viewAbout",value:function(){this.rewriteView(this.aboutView.render()),this.topBar.setData({title:"".concat(P.getLocale("aboutTitle"),".")})}},{key:"resolve",value:function(e){switch(this.parentElement.innerHTML="",this.parentElement.append(this.rootEl),this.generateSidebarData(e),e.slice(1)){case"levels":this.viewLevels();break;case"settings":this.viewSettings();break;case"about":this.viewAbout();break;case"score":this.viewScore()}}}])&&ye(t.prototype,n),r&&ye(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function we(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Ee=function(){function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.rootEl=document.createElement("div"),this.rootEl.classList.add("overlay"),this.rootEl.classList.add("overlay_blur"),this.buttonSelect=document.createElement("button"),this.buttonSelect.classList.add("variant-popup__button"),this.buttonSelect.classList.add("variant-popup__button_select"),this.buttonSelect.textContent=P.getLocale("gameSelectTitle"),this.buttonCancel=document.createElement("button"),this.buttonCancel.classList.add("variant-popup__button"),this.buttonCancel.classList.add("variant-popup__button_cancel"),this.buttonCancel.textContent=P.getLocale("gameCancelTitle"),this.buttonCancel.onclick=function(){return t.hide()},this.variantButtons=document.createElement("div"),this.variantButtons.classList.add("variant-popup__buttons"),this.variantButtons.append(this.buttonCancel),this.variantButtons.append(this.buttonSelect),this.downloadButton=document.createElement("button"),this.downloadButton.classList.add("variant-popup__download-button")}var t,n,r;return t=e,(n=[{key:"setData",value:function(e){var t=this,n=e.answer,r=e.question,a=e.questionPopup,i=e.startTime,o=document.createElement("div");o.classList.add("variant-popup");var s=document.createElement("div");s.classList.add("variant-popup__image");var l=document.createElement("img");l.src=n.getImageSrc(),l.alt="variant",s.append(l),s.append(this.downloadButton);var u=n.getImageSrc().split("/").reverse()[0];this.downloadButton.onclick=function(){return function(e,t){var n=document.createElement("a");n.setAttribute("href",e),n.setAttribute("download",t),document.body.appendChild(n),n.click(),document.body.removeChild(n)}(n.getImageSrc(),u)},o.append(s),o.append(this.variantButtons),this.rootEl.innerHTML="",this.rootEl.append(o),this.buttonSelect.onclick=function(){t.hide(),a.setData({question:r,answer:n,startTime:i}),a.show()}}},{key:"hide",value:function(){this.rootEl.classList.add("overlay_hidden")}},{key:"show",value:function(){this.rootEl.classList.remove("overlay_hidden")}},{key:"render",value:function(){return this.rootEl}}])&&we(t.prototype,n),r&&we(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function Le(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var ke=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.rootEl=document.createElement("div"),this.rootEl.classList.add("overlay"),this.rootEl.classList.add("overlay_blur"),this.popupContainer=document.createElement("div"),this.popupContainer.classList.add("question-popup"),this.buttonNext=document.createElement("button"),this.buttonNext.classList.add("question-popup__button"),this.rootEl.append(this.popupContainer)}var t,n,r;return t=e,(n=[{key:"setData",value:function(e){var t,n,r,a=e.answer,i=e.question,o=e.startTime;t=a,n=i,(r=new re(-1)).setAnswerDate((new Date).toISOString()),r.setAnswerId(t.getId()),r.setQuestionId(n.getId()),r.setThinkingTime((new Date).getTime()-o),ue.setUserAnswer(r);var s=document.createElement("div");s.classList.add("question-popup__result"),this.buttonNext.textContent=P.getLocale("gameNextButtonTitle");var l=document.createElement("div");if(l.classList.add("question-popup__result-description"),i.getCorrectAnswerId()===a.getId()){s.innerText=P.getLocale("gameAnswerCorrect");var u=document.createElement("div");u.classList.add("question-popup__desc-pair"),u.innerText=P.getLocale("gamePictureNameTitle");var c=document.createElement("p");c.innerText='"'.concat(a.getName()[P.getLocale("localeName")],'"'),u.append(c);var d=document.createElement("div");d.classList.add("question-popup__desc-pair"),d.innerText=P.getLocale("gameMadeByTitle");var h=document.createElement("p");h.innerText=a.getAuthor()[P.getLocale("localeName")],d.append(h);var f=document.createElement("div");f.classList.add("question-popup__desc-pair"),f.innerText=P.getLocale("gameYearTitle");var p=document.createElement("p");p.innerText=a.getYear(),f.append(p),l.append(u),l.append(d),l.append(f),s.classList.add("question-popup__result_correct")}else s.innerText=P.getLocale("gameAnswerIncorrect"),s.classList.add("question-popup__result_incorrect");this.popupContainer.innerHTML="",this.popupContainer.append(s),this.popupContainer.append(l),this.popupContainer.append(this.buttonNext)}},{key:"hide",value:function(){this.rootEl.classList.add("overlay_hidden")}},{key:"show",value:function(){this.rootEl.classList.remove("overlay_hidden")}},{key:"render",value:function(){return this.rootEl}}])&&Le(t.prototype,n),r&&Le(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}(),Te=e.p+"assets/f2850b52a194c5fefb0d.png";function Pe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Ce=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.rootEl=document.createElement("div"),this.rootEl.classList.add("result-card"),this.rootEl=document.createElement("div"),this.rootEl.classList.add("result-list__card"),this.rootEl.classList.add("result-card"),this.imageContainer=document.createElement("div"),this.imageContainer.classList.add("result-card__image"),this.imageEl=document.createElement("img"),this.imageContainer.append(this.imageEl),this.resultText=document.createElement("div"),this.resultText.classList.add("result-card__text"),this.resultTitle=document.createElement("div"),this.resultTitle.classList.add("result-card__question-name"),this.resultStats=document.createElement("div"),this.resultStats.classList.add("result-card__question-stats"),this.resultText.append(this.resultTitle),this.resultText.append(this.resultStats),this.rootEl.append(this.imageContainer),this.rootEl.append(this.resultText)}var t,n,r;return t=e,(n=[{key:"setData",value:function(e){var t=e.isUserAnswerCorrect(),n=e.getUserAnswer();if(console.error(n),this.imageEl.alt="question img",this.imageEl.src=Te,null!=n&&t){this.imageEl.src=e.getImageSrc(),this.resultTitle.textContent=P.getLocale("gameAnswerCorrect");var r=e.getCorrectAnswer(),a="".concat(r.getAuthor()[P.getLocale("localeName")]," - ").concat(r.getName()[P.getLocale("localeName")]);a.length>34&&(a=a.slice(0,34).concat("...")),this.resultStats.textContent=a}null!==n&&t||(this.rootEl.classList.add("result-card_locked"),this.resultTitle.textContent=P.getLocale("gameAnswerIncorrect"),null===n&&(this.resultTitle.textContent=P.getLocale("gameResultNoAnswer")))}},{key:"render",value:function(){return this.rootEl}}])&&Pe(t.prototype,n),r&&Pe(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function Ie(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Se=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.rootEl=document.createElement("div"),this.rootEl.classList.add("result-list")}var t,n,r;return t=e,(n=[{key:"setData",value:function(e){var t=this;this.rootEl.innerHTML="",e.levelModel.getQuestions().forEach((function(e){var n=new Ce;n.setData(e),t.rootEl.append(n.render())}))}},{key:"render",value:function(){return this.rootEl}}])&&Ie(t.prototype,n),r&&Ie(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function Oe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Ae=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.rootEl=document.createElement("div"),this.rootEl.classList.add("level-result"),this.title=document.createElement("div"),this.title.classList.add("level-result__title"),this.resultStatsContainer=document.createElement("div"),this.resultStatsContainer.classList.add("level-result__stats-container"),this.nextButton=document.createElement("div"),this.nextButton.classList.add("level-result__button-next"),this.rootEl.append(this.title,this.resultStatsContainer,this.nextButton)}var t,n,r;return t=e,(n=[{key:"setData",value:function(e){var t=e.isUnlocked,n=e.isFreshUnlocked,r=e.levelModel,a=e.numberOfAnsweredQuestions,i=e.numberOfCorrectAnsweredQuestions,s=function(e,t,n,r){var a=document.createElement("div");a.classList.add("level-result__stats-card"),a.classList.add("stats-card");var i=document.createElement("div");i.classList.add("stats-card__measurement");var o=document.createElement("div");o.classList.add("stats-card__measurement-line");var s=document.createElement("div");s.classList.add("stats-card__measurement-indicator"),r?s.classList.add("stats-card__measurement-indicator_correct"):s.classList.add("stats-card__measurement-indicator_incorrect");var l=document.createElement("div");l.classList.add("stats-card__measurement-text"),l.innerText=n;var u=document.createElement("div");u.classList.add("stats-card__title"),u.innerText=e;var c=n/(t/100);return s.style.width="".concat(c,"%"),o.append(s),i.append(o,l),a.append(u,i),a},l="";if(this.nextButton.innerText=P.getLocale("gameResultBackToLevels"),this.nextButton.onclick=function(){return o.setCurrentPath("/main/levels/")},t?(l=P.getLocale("gameResultLevelComplete"),this.nextButton.innerText=P.getLocale("gameNextButtonTitle"),this.nextButton.onclick=function(){return o.setCurrentPath("/game/level/".concat(r.getId()+1))}):l=P.getLocale("gameResultTryAgain"),n&&(l+=" ".concat(P.getLocale("gameResultGoodJob"))),this.title.innerText=l,this.resultStatsContainer.innerHTML="",null!=a&&a>0){var u=s(P.getLocale("gameAnswerCorrect"),a,i,!0),c=s(P.getLocale("gameAnswerIncorrect"),a,a-i,!1);this.resultStatsContainer.append(u,c)}}},{key:"render",value:function(){return this.rootEl}}])&&Oe(t.prototype,n),r&&Oe(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function je(e){return function(e){if(Array.isArray(e))return _e(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return _e(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _e(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _e(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function De(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var qe=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.rootEl=document.createElement("div"),this.rootEl.classList.add("question-card")}var t,n,r;return t=e,(n=[{key:"setData",value:function(e){var t,n,r=(new Date).getTime(),a=e.question,i=function(e){for(var t=je(e),n=t.length-1;n>0;n-=1){var r=Math.floor(Math.random()*(n+1)),a=t[n];t[n]=t[r],t[r]=a}return t};if(a.getQuestionType()===$.QuestionTypes.WhoIs){this.rootEl.classList.add("question-whois");var s=document.createElement("div");s.classList.add("question-card__question");var l=document.createElement("div");l.classList.add("question-card__image");var u=document.createElement("button");u.classList.add("variant-popup__download-button");var c=document.createElement("img");c.src=a.getImageSrc(),c.alt=P.getLocale("gameQuestionType1");var d=document.createElement("div");d.classList.add("question-card__title"),d.innerText=P.getLocale("gameQuestionType1");var h=document.createElement("div");h.classList.add("question-card_answers-grid");var f=a.getImageSrc().split("/").reverse()[0];u.onclick=function(){return function(e,t){var n=document.createElement("a");n.setAttribute("href",e),n.setAttribute("download",t),document.body.appendChild(n),n.click(),document.body.removeChild(n)}(a.getImageSrc(),f)},i((t=a.getAnswers(),n=e,t.map((function(e){var t=n.questionPopup,a=document.createElement("div");return a.classList.add("question-card_answer"),a.innerText=e.getAuthor()[P.getLocale("localeName")],a.onclick=function(){t.setData({answer:e,question:n.question,startTime:r}),t.show()},a})))).forEach((function(e){return h.append(e)})),l.append(c,u),s.append(l),s.append(d),this.rootEl.append(s),this.rootEl.append(h)}else if(a.getQuestionType()===$.QuestionTypes.WhichIs){this.rootEl.classList.add("question-which");var p=document.createElement("div");p.classList.add("question-which_answers-grid");var v=function(e,t){return e.map((function(e){var n=t.variantPopup,a=document.createElement("div");a.classList.add("question-which_answer");var i=document.createElement("img");return i.alt=P.getLocale("gameQuestionType2"),i.src=e.getImageSrc(),a.onclick=function(){n.setData({answer:e,question:t.question,questionPopup:t.questionPopup,startTime:r}),n.show()},a.append(i),a}))}(a.getAnswers(),e);i(v).forEach((function(e){return p.append(e)}));var g=document.createElement("div");g.classList.add("question-which__question");var y=document.createElement("div");y.classList.add("question-which__title");var b=a.getAnswers().filter((function(e){return e.getId()===a.getCorrectAnswerId()}))[0];y.innerHTML="".concat(P.getLocale("gameQuestionType2"),"<b>").concat(b.getAuthor()[P.getLocale("localeName")],"?</b>"),g.append(y),this.rootEl.append(p),this.rootEl.append(g)}e.questionPopup.buttonNext.onclick=function(){if(e.questionPopup.hide(),a.getNumber()<m.getQuestionsPerLevel()){var t="/game/level/".concat(a.getLevelId(),"/question/").concat(parseInt(a.getNumber(),10)+1);o.setCurrentPath(t)}else if(a.getNumber()===m.getQuestionsPerLevel()){var n="/game/level/".concat(a.getLevelId(),"/result");o.setCurrentPath(n)}}}},{key:"hide",value:function(){this.rootEl.classList.add("question-card_hidden")}},{key:"setActive",value:function(){this.rootEl.classList.add("question-card_active")}},{key:"render",value:function(){return this.rootEl}}])&&De(t.prototype,n),r&&De(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function xe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Be=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.rootEl=document.createElement("div"),this.rootEl.classList.add("question-cards-container"),this.rootEl.innerText="Questions here"}var t,n,r;return t=e,(n=[{key:"setData",value:function(e){this.rootEl.innerHTML="";var t=new qe,n=e.level.getQuestions().filter((function(t){return t.getNumber()===parseInt(e.questionNumber,10)}))[0];t.setData({question:n,variantPopup:e.variantPopup,questionPopup:e.questionPopup}),this.rootEl.appendChild(t.render())}},{key:"hide",value:function(){this.rootEl.classList.remove("game-question-page_hidden")}},{key:"render",value:function(){return this.rootEl}}])&&xe(t.prototype,n),r&&xe(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function Ne(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Me=function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.parentElement=t,this.rootEl=document.createElement("div"),this.rootEl.classList.add("container"),this.questionCardsContainer=new Be,this.gameQuestionsPage=document.createElement("div"),this.gameQuestionsPage.classList.add("game-question-page"),this.gameResultPage=document.createElement("div"),this.gameResultPage.classList.add("game-result-page"),this.resultList=new Se,this.levelResult=new Ae,this.gameHeaderContainer=document.createElement("div"),this.gameHeaderContainer.classList.add("header-container"),this.resultTopBar=new h,this.resultTopBar.setData({title:"".concat(P.getLocale("levelResult")),isSmall:!1}),this.topBar=new h,this.topBar.setData({title:"".concat(P.getLocale("levelTitle")," 0"),isSmall:!0}),this.sidebar=new c,this.generateSidebarData(),this.sidebar.hide(),this.variantPopup=new Ee,this.variantPopup.hide(),this.questionPopup=new ke,this.questionPopup.hide(),this.questionsNumbersList=new j,this.gameHeaderContainer.append(this.topBar.render()),this.gameHeaderContainer.append(this.questionsNumbersList.render()),this.gameQuestionsPage.append(this.gameHeaderContainer),this.gameQuestionsPage.append(this.questionCardsContainer.render()),this.gameQuestionsPage.append(this.variantPopup.render()),this.gameQuestionsPage.append(this.questionPopup.render()),this.gameResultPage.append(this.resultTopBar.render()),this.gameResultPage.append(this.levelResult.render(),this.resultList.render()),this.rootEl.append(this.sidebar.render()),this.rootEl.append(this.gameQuestionsPage),this.sidebar.buttonClose.onclick=function(){n.sidebar.hide()},this.topBar.menuButton.onclick=function(){n.sidebar.show()},this.resultTopBar.menuButton.onclick=function(){n.sidebar.show()}}var t,n,r;return t=e,(n=[{key:"generateSidebarData",value:function(){var e={separatorText:P.getLocale("sidebarMotto"),currentPath:"!current",menu:[{text:"[".concat(P.getLocale("gamePaused"),"]"),path:"!current",action:null},{text:P.getLocale("levelsTitle"),path:"/main/levels",action:o.setCurrentPath}],fastLangSw:[{text:"eng",action:function(){P.setCurrentLocale(0),o.setCurrentPath(o.getCurrentPath())}},{text:"ru",action:function(){P.setCurrentLocale(1),o.setCurrentPath(o.getCurrentPath())}}]};this.sidebar.setData(e)}},{key:"showQuestion",value:function(e,t){t.getIsLocked()||(this.questionsNumbersList.setData({levelModel:t,questionNumber:e}),this.topBar.setData({title:"".concat(P.getLocale("levelTitle")," ").concat(t.getId()),isSmall:!0}),this.questionCardsContainer.setData({level:t,variantPopup:this.variantPopup,questionPopup:this.questionPopup,questionNumber:e}))}},{key:"showLevelResult",value:function(e){var t=this;if(!e.getIsLocked()){this.questionsNumbersList.setData({levelModel:e}),this.resultTopBar.setData({title:"".concat(P.getLocale("levelResults")),isSmall:!1});var n=e.getNumberOfAnsweredQuestions(),r=e.getNumberOfCorrectAnsweredQuestions(),a=!1,i=!1;r/(n/100)>=60&&(a=!0,ge.getById(e.id+1).then((function(o){o&&o.getIsLocked()&&(ge.setLevelIsLockeById(e.id+1,!1),i=!0),t.levelResult.setData({isUnlocked:a,isFreshUnlocked:i,levelModel:e,numberOfAnsweredQuestions:n,numberOfCorrectAnsweredQuestions:r})}))),this.levelResult.setData({isUnlocked:a,isFreshUnlocked:i,levelModel:e,numberOfAnsweredQuestions:n,numberOfCorrectAnsweredQuestions:r}),this.resultList.setData({levelModel:e}),this.renderPage(this.gameResultPage)}}},{key:"renderPage",value:function(e){this.rootEl.innerHTML="",this.rootEl.append(this.sidebar.render()),this.rootEl.append(e)}},{key:"resolve",value:function(e){var t=this;this.generateSidebarData(),this.parentElement.innerHTML="",this.parentElement.append(this.rootEl),this.sidebar.hide();var n=e.slice(1).split("/"),r=Number.parseInt(n[1],10),a=Number.parseInt(n[3],10);"level"===n[0]&&(4===n.length&&"question"===n[2]?ge.getById(r).then((function(e){t.showQuestion(a,e)})):3===n.length&&"result"===n[2]?ge.getById(r).then((function(e){t.showLevelResult(e)})):2===n.length&&fe.getLastWithAnswerByLevelId(r).then((function(e){var t=null!=e?e.getNumber():0;t>=10?t=1:t+=1,o.setCurrentPath("/game/level/".concat(r,"/question/").concat(t))}))),this.renderPage(this.gameQuestionsPage)}}])&&Ne(t.prototype,n),r&&Ne(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function Qe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}new(function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.className=t,this.rootEl=document.getElementsByClassName(t)[0],this.userSettings=new r,this.router=new l,this.mainController=new be(this.rootEl),this.gameController=new Me(this.rootEl)}var t,n,a;return t=e,(n=[{key:"run",value:function(){this.router.addRoute("/main",this.mainController),this.router.addRoute("/game",this.gameController),y.isEmpty().then((function(e){e?fetch(m.getDefaultStaticJsonSrcPath()).then((function(e){return e.json()})).then((function(e){y.srcData=e,o.setCurrentPath("/main/levels")})):L.getSettings().then((function(e){P.setCurrentLocale(e.getLanguage()),o.getRealCurrentPath()&&""!==o.getRealCurrentPath()?o.setCurrentPath(o.getRealCurrentPath()):o.setCurrentPath("/main/levels")}))}))}}])&&Qe(t.prototype,n),a&&Qe(t,a),Object.defineProperty(t,"prototype",{writable:!1}),e}())("app").run()}();