!function(){"use strict";function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function t(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var n=function(){function n(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),t(this,"gameDifficulty",null),t(this,"soundLevel",null),t(this,"language",null),t(this,"userName",null),t(this,"auth",null)}var r,a,i;return r=n,(a=[{key:"getUserName",value:function(){return this.userName}},{key:"setUserName",value:function(e){this.userName=e}},{key:"getAuth",value:function(){return this.auth}},{key:"setAuth",value:function(e){this.auth=e}},{key:"getGameDifficulty",value:function(){return this.gameDifficulty}},{key:"setGameDifficulty",value:function(e){var t=e;t<0&&(t=n.GameDifficulty.easy),t>3&&(t=n.GameDifficulty.nightmare),this.gameDifficulty=t}},{key:"getSoundLevel",value:function(){return this.soundLevel}},{key:"setSoundLevel",value:function(e){var t=e;t<0&&(t=0),t>100&&(t=100),this.soundLevel=t}},{key:"getLanguage",value:function(){return this.language}},{key:"setLanguage",value:function(e){var t=e;"eng"===e&&"ru"===e||(t="eng"),this.language=t}},{key:"toJSON",value:function(){return JSON.stringify({gameDifficulty:this.gameDifficulty,soundLevel:this.soundLevel,language:this.language})}},{key:"fromJsonObj",value:function(e){this.gameDifficulty=e.gameDifficulty,this.soundLevel=e.soundLevel,this.language=e.language}}])&&e(r.prototype,a),i&&e(r,i),Object.defineProperty(r,"prototype",{writable:!1}),n}();function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}t(n,"GameDifficulty",{easy:0,normal:1,hard:2,nightmare:3});var i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,a;return t=e,a=[{key:"setCurrentPath",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e.path=t,window.location.hash=t,e.callbacksArray.forEach((function(e){e(t,n)}))}},{key:"getCurrentPath",value:function(){return e.path}},{key:"getRealCurrentPath",value:function(){return window.location.hash.slice(1)}},{key:"addPathChangeListener",value:function(t){e.callbacksArray.push(t)}}],(n=null)&&r(t.prototype,n),a&&r(t,a),Object.defineProperty(t,"prototype",{writable:!1}),e}();function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}a(i,"data",{}),a(i,"path",null),a(i,"callbacksArray",[]);var s=function(){function e(){var t,n,r,a=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),r=[],(n="routes")in(t=this)?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,window.addEventListener("hashchange",(function(){window.location.hash.slice(1)!==i.getCurrentPath()&&i.setCurrentPath(window.location.hash.slice(1))}),!1),i.addPathChangeListener((function(e,t){a.resolve(e,t)}))}var t,n,r;return t=e,(n=[{key:"resolve",value:function(e,t){this.routes.forEach((function(n){n.path==="/".concat(e.split("/")[1])&&n.controller.resolve(e.replace(n.path,""),t)}))}},{key:"addRoute",value:function(e,t){this.routes.push({path:e,controller:t})}}])&&o(t.prototype,n),r&&o(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var l=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.data=t,this.isHidden=!1,this.rootEl=document.createElement("div"),this.rootEl.classList.add("sidebar"),this.sidebarContainer=document.createElement("div"),this.sidebarContainer.classList.add("sidebar__container"),this.buttonClose=document.createElement("div"),this.buttonClose.classList.add("button-close"),this.sidebarVerticalSeparator=document.createElement("div"),this.sidebarVerticalSeparator.classList.add("sidebar__vertical-separator"),this.mainMenuList=document.createElement("div"),this.mainMenuList.classList.add("main-menu__list"),this.fastLangSwitch=document.createElement("div"),this.fastLangSwitch.classList.add("main-menu__fast-lang-sw","fast-lang-sw"),this.rootEl.append(this.sidebarContainer)}var t,n,r;return t=e,(n=[{key:"setData",value:function(e){var t=this;this.data=e,this.sidebarContainer.innerHTML="",this.mainMenu=document.createElement("div"),this.mainMenu.classList.add("sidebar__main-menu","main-menu"),this.mainMenuList.innerHTML="",this.data.menu.forEach((function(n){var r=document.createElement("button");r.classList.add("main-menu__list-button"),r.textContent=n.text,r.onclick=function(){t.hide(),n.action(n.path)},e.currentPath&&e.currentPath===n.path&&(r.classList.add("main-menu__list-button_current"),r.onclick=null),t.mainMenuList.append(r)})),this.sidebarVerticalSeparator.innerHTML="";var n=document.createElement("span");n.innerText=this.data.separatorText;for(var r=0;r<10;r+=1)this.sidebarVerticalSeparator.append(n.cloneNode(!0));this.fastLangSwitch.innerHTML="",this.data.fastLangSw.forEach((function(e){var n=document.createElement("button");n.classList.add("fast-lang-sw__lang-button"),n.textContent=e.text,n.onclick=e.action,t.fastLangSwitch.append(n)})),this.mainMenu.append(this.buttonClose),this.mainMenu.append(this.mainMenuList),this.mainMenu.append(this.fastLangSwitch),this.sidebarContainer.appendChild(this.sidebarVerticalSeparator),this.sidebarContainer.appendChild(this.mainMenu)}},{key:"render",value:function(){return this.rootEl}},{key:"hide",value:function(){this.rootEl.classList.add("sidebar_hidden"),this.isHidden=!0}},{key:"show",value:function(){this.rootEl.classList.remove("sidebar_hidden"),this.isHidden=!1}}])&&u(t.prototype,n),r&&u(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var d=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.dataPlaceholder={title:"Art-Quiz.",isSmall:!1},this.rootEl=document.createElement("div"),this.rootEl.classList.add("top-bar"),this.menuButton=document.createElement("div"),this.menuButton.classList.add("burger-menu"),this.title=document.createElement("div"),this.title.classList.add("top-bar__title"),this.rootEl.appendChild(this.menuButton),this.rootEl.appendChild(this.title)}var t,n,r;return t=e,(n=[{key:"setData",value:function(e){e&&Object.keys(e).length>=1?this.data=e:this.data=this.dataPlaceholder,this.title.textContent=this.data.title,this.data.isSmall&&this.rootEl.classList.add("top-bar_s")}},{key:"render",value:function(){return this.rootEl}}])&&c(t.prototype,n),r&&c(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function h(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function f(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var p=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"getLocale",value:function(t){return e.locales[e.currentLocale][t]}}],(n=null)&&h(t.prototype,n),r&&h(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function v(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}f(p,"currentLocale",0),f(p,"locales",[{localeName:"eng",title:"ArtQuiz",levelTitle:"Level",settingsTitle:"Settings",levelsTitle:"Levels",scoreTitle:"Score",aboutTitle:"About",sidebarMotto:"CREATE TEST DEPLOY BE SMART",levelLockedTitle:"Locked",levelStatsTitle:"Done",gamePaused:"Paused",gameQuestionType1:"Who wrote this picture?",gameQuestionType2:"Which one is written by",gameSelectTitle:"Select",gameCancelTitle:"Cancel",gameAnswerCorrect:"Correct",gameAnswerIncorrect:"Incorrect",gameNextButtonTitle:"Next",gamePictureNameTitle:"This is:",gameMadeByTitle:"Made by:",gameYearTitle:"Year of creation:"},{localeName:"ru",title:"ArtQuiz",levelTitle:"Уровень",settingsTitle:"Настройки",levelsTitle:"Уровни",scoreTitle:"Счёт",aboutTitle:"О игре",sidebarMotto:"СОЗДАВАЙ ТЕСТИРУЙ РАЗВОРАЧИВАЙ БУДЬ УМЁН",levelLockedTitle:"Заблокировано",levelStatsTitle:"Отвечено",gamePaused:"Пауза",gameQuestionType1:"Кто написал эту картину?",gameQuestionType2:"Какую из картин написал автор",gameSelectTitle:"Выбрать",gameCancelTitle:"Отмена",gameAnswerCorrect:"Правильно",gameAnswerIncorrect:"Неправильно",gameNextButtonTitle:"Далее",gamePictureNameTitle:"Картина называется:",gameMadeByTitle:"Написана автором:",gameYearTitle:"Год создания:"}]);var m=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.dataPlaceholder={id:-1,imgSrc:"static/img/jpg/square/0.jpg",isLocked:!1,text:""},this.rootEl=document.createElement("div"),this.rootEl.classList.add("level-card"),this.rootEl.classList.add("level-list__card"),this.imageContainer=document.createElement("div"),this.imageContainer.classList.add("level-card__image"),this.imageEl=document.createElement("img"),this.imageContainer.append(this.imageEl),this.levelText=document.createElement("div"),this.levelText.classList.add("level-card__text"),this.levelTitle=document.createElement("div"),this.levelTitle.classList.add("level-card__level-name"),this.levelStats=document.createElement("div"),this.levelStats.classList.add("level-card__level-stats"),this.levelText.append(this.levelTitle),this.levelText.append(this.levelStats),this.rootEl.append(this.imageContainer),this.rootEl.append(this.levelText),this.setData(t)}var t,n,r;return t=e,(n=[{key:"setData",value:function(e){e&&Object.keys(e).length>=1&&(this.data=e,this.imageEl.src=this.data.getImageSrc(),this.imageEl.alt="".concat(p.getLocale("levelTitle")," ").concat(this.data.getId()),this.levelTitle.textContent="".concat(p.getLocale("levelTitle")," ").concat(this.data.getId()),this.levelStats.textContent=this.data.getIsLocked()?p.getLocale("levelLockedTitle"):"".concat(p.getLocale("levelStatsTitle")," ").concat(this.data.getQuestionsAnsweredNumber(),"/").concat(this.data.getQuestionsNumber()),this.data.getIsLocked()&&this.rootEl.classList.add("level-card_locked"))}},{key:"render",value:function(){return this.rootEl}}])&&v(t.prototype,n),r&&v(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function g(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var y=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.rootEl=document.createElement("div"),this.rootEl.classList.add("level-list"),this.levelsList=[]}var t,n,r;return t=e,(n=[{key:"setData",value:function(e){var t=this;e&&(this.levelsList=[],this.rootEl.innerHTML="",e.levelsList.forEach((function(e){var n=new m;n.setData(e),t.levelsList.push(n),e.getIsLocked()||(n.render().onclick=function(){i.setCurrentPath("/game/level/".concat(e.getId()))}),t.rootEl.append(n.render())})))}},{key:"render",value:function(){return this.rootEl}}])&&g(t.prototype,n),r&&g(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function b(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var w=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.rootEl=document.createElement("div"),this.rootEl.classList.add("questions-numbers-list")}var t,n,r;return t=e,(n=[{key:"setData",value:function(e){var t=this,n=e.levelModel,r=e.questionNumber;this.rootEl.innerHTML="",n.getQuestions().forEach((function(e,n){var a=document.createElement("div");a.classList.add("questions-numbers-list__item");var i=document.createElement("p");i.innerText=e.getNumber(),e.getUserAnswer()&&(e.isUserAnswerCorrect()?a.classList.add("questions-numbers-list__item_correct"):a.classList.add("questions-numbers-list__item_incorrect")),r>=0&&n===r-1&&a.classList.add("questions-numbers-list__item_active"),a.append(i),t.rootEl.append(a)}))}},{key:"render",value:function(){return this.rootEl}}])&&b(t.prototype,n),r&&b(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function E(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var k=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.rootEl=document.createElement("div"),this.rootEl.classList.add("score-card")}var t,n,r;return t=e,(n=[{key:"setData",value:function(e){var t=document.createElement("div");t.classList.add("score-card__wrapper");var n=document.createElement("div");n.classList.add("score-card__text"),n.innerText="".concat(e.getQuestionsAnsweredNumber(),"/").concat(e.getQuestionsNumber());var r=document.createElement("div");r.classList.add("score-card__title"),r.innerText="".concat(p.getLocale("levelTitle")," ").concat(e.getId());var a=new w;a.setData({levelModel:e}),e.getIsLocked()&&this.rootEl.classList.add("score-card_locked"),t.append(n,r,a.render()),this.rootEl.style.backgroundImage="url('".concat(e.getImageSrc(),"')"),this.rootEl.append(t)}},{key:"render",value:function(){return this.rootEl}}])&&E(t.prototype,n),r&&E(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function L(e){return function(e){if(Array.isArray(e))return T(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return T(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return T(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function T(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function P(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var I=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.rootEl=document.createElement("div"),this.rootEl.classList.add("score-cards-container")}var t,n,r;return t=e,(n=[{key:"setData",value:function(e){var t,n=e.levelsList.map((function(e){var t=new k;return t.setData(e),t.render()}));(t=this.rootEl).append.apply(t,L(n))}},{key:"render",value:function(){return this.rootEl}}])&&P(t.prototype,n),r&&P(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function S(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var C=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.rootEl=document.createElement("div"),this.rootEl.classList.add("score-list")}var t,n,r;return t=e,(n=[{key:"setData",value:function(e){this.rootEl.innerHTML="";var t=new I;t.setData(e),this.rootEl.append(t.render())}},{key:"render",value:function(){return this.rootEl}}])&&S(t.prototype,n),r&&S(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function A(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var D=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.rootEl=document.createElement("div"),this.rootEl.classList.add("settings"),this.rootEl.innerText="Settings"}var t,n,r;return t=e,(n=[{key:"render",value:function(){return this.rootEl}}])&&A(t.prototype,n),r&&A(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function j(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var _=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.rootEl=document.createElement("div"),this.rootEl.classList.add("about"),this.rootEl.innerText="About"}var t,n,r;return t=e,(n=[{key:"render",value:function(){return this.rootEl}}])&&j(t.prototype,n),r&&j(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function O(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function q(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var x=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"getDefaultStaticSquareImagesPath",value:function(){return e.defaultStaticSquareImagesPath}},{key:"getDefaultStaticFullImagesPath",value:function(){return e.defaultStaticFullImagesPath}},{key:"getDefaultStaticJsonSrcPath",value:function(){return e.defaultStaticJsonSrcPath}},{key:"getQuestionsPerLevel",value:function(){return e.questionsPerLevel}}],(n=null)&&O(t.prototype,n),r&&O(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function N(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function B(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}q(x,"questionsPerLevel",10),q(x,"defaultStaticSquareImagesPath","static/img/jpg/square/"),q(x,"defaultStaticFullImagesPath","static/img/jpg/full/"),q(x,"defaultStaticJsonSrcPath","static/json/imagesTranslated.json");var M=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"getData",value:function(){return new Promise((function(t){null!==e.cachedData&&e.isCacheActive?t(e.cachedData):e.isEmpty().then((function(n){if(!n){var r=localStorage.getItem(e.localStorageItemName),a=JSON.parse(r),i=Object.keys(a).length>0?a:null;if(null!=i)return e.cachedData=i,void t(i)}var o=e.generateData();e.setData(o),t(o)}))}))}},{key:"destroy",value:function(){localStorage.removeItem(e.localStorageItemName)}},{key:"isEmpty",value:function(){return new Promise((function(t){var n=localStorage.getItem(e.localStorageItemName);t(!(n&&"{"===n[0]))}))}},{key:"setData",value:function(t){e.cachedData=t,localStorage.setItem(e.localStorageItemName,JSON.stringify(t))}},{key:"generateData",value:function(){var t=function(e,t){var n=Math.ceil(e),r=Math.floor(t);return Math.floor(Math.random()*(r-n+1))+n};localStorage.removeItem(e.localStorageItemName);var n=0,r=0,a=0,i=1,o=x.getDefaultStaticSquareImagesPath(),s=x.getQuestionsPerLevel(),u={settings:{},gameDB:{level:[],question:[],answer:[],userAnswer:[]}};return e.srcData.data.forEach((function(e,l,c){l%s==0&&(l>=s&&(n+=1),u.gameDB.level.push({id:n,imageSrc:"".concat(o).concat(e.imageId,".jpg"),isLocked:n>=2,text:""})),u.gameDB.question.push({id:r,levelId:n,number:i,questionType:t(1,2),correctAnswerId:a,imageSrc:"".concat(o).concat(e.imageId,".jpg"),text:""}),u.gameDB.answer.push({id:a,questionId:r,imageSrc:"".concat(o).concat(e.imageId,".jpg"),text:"",name:e.name,author:e.author,year:e.year}),a+=1;for(var d=[],h=[],f=function(e){for(var n=t(0,c.length-1);-1!==h.findIndex((function(e){return e===n}));)n=t(0,c.length-1);h.push(n),d.push({id:a,questionId:r,imageSrc:"".concat(o).concat(c[n].imageId,".jpg"),text:"",name:c[n].name,author:c[n].author,year:c[n].year}),a+=1},p=0;p<3;p+=1)f();d.forEach((function(e){return u.gameDB.answer.push(e)})),r+=1,i=i<s?i+=1:1})),u}}],(n=null)&&N(t.prototype,n),r&&N(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function Q(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function V(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}B(M,"localStorageItemName","art-quiz-game-data"),B(M,"srcData",null),B(M,"cachedData",null),B(M,"isCacheActive",!0);var H=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),V(this,"id",-1),V(this,"imageSrc",null),V(this,"text",null),V(this,"isLocked",!0),V(this,"questions",null),this.id=t}var t,n,r;return t=e,(n=[{key:"getImageSrc",value:function(){return this.imageSrc}},{key:"setImageSrc",value:function(e){this.imageSrc=e}},{key:"getId",value:function(){return this.id}},{key:"getQuestions",value:function(){return this.questions}},{key:"setQuestions",value:function(e){this.questions=e}},{key:"getText",value:function(){return this.text}},{key:"setText",value:function(e){this.text=e}},{key:"getIsLocked",value:function(){return this.isLocked}},{key:"setIsLocked",value:function(e){this.isLocked=e}},{key:"getQuestionsNumber",value:function(){return this.questions.length}},{key:"getQuestionsAnsweredNumber",value:function(){return this.questions.filter((function(e){return null!==e.userAnswer})).length}}])&&Q(t.prototype,n),r&&Q(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function U(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function J(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var R=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),J(this,"id",-1),J(this,"levelId",-1),J(this,"number",void 0),J(this,"questionType",null),J(this,"answers",null),J(this,"correctAnswerId",-1),J(this,"userAnswer",null),J(this,"imageSrc",null),J(this,"text",null),this.id=t,this.levelId=n}var t,n,r;return t=e,(n=[{key:"getLevelId",value:function(){return this.levelId}},{key:"setLevelId",value:function(e){this.levelId=e}},{key:"getId",value:function(){return this.id}},{key:"getNumber",value:function(){return this.number}},{key:"setNumber",value:function(e){this.number=e}},{key:"getImageSrc",value:function(){return this.imageSrc}},{key:"setImageSrc",value:function(e){this.imageSrc=e}},{key:"getText",value:function(){return this.text}},{key:"setText",value:function(e){this.text=e}},{key:"getQuestionType",value:function(){return this.questionType}},{key:"setQuestionType",value:function(e){this.questionType=e}},{key:"getAnswers",value:function(){return this.answers}},{key:"setAnswers",value:function(e){this.answers=e}},{key:"getCorrectAnswerId",value:function(){return this.correctAnswerId}},{key:"setCorrectAnswerId",value:function(e){this.correctAnswerId=e}},{key:"getUserAnswer",value:function(){return this.userAnswer}},{key:"setUserAnswer",value:function(e){this.userAnswer=e}},{key:"isUserAnswerCorrect",value:function(){return!!this.userAnswer&&null!=this.userAnswer.getAnswerId()&&this.userAnswer.getAnswerId()===this.correctAnswerId}}])&&U(t.prototype,n),r&&U(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function Y(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function W(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}J(R,"QuestionTypes",{WhoIs:1,WhichIs:2});var G=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),W(this,"id",-1),W(this,"questionId",-1),W(this,"imageSrc",null),W(this,"author",null),W(this,"name",null),W(this,"year",null),this.id=t}var t,n,r;return t=e,(n=[{key:"getQuestionId",value:function(){return this.questionId}},{key:"setQuestionId",value:function(e){this.questionId=e}},{key:"getId",value:function(){return this.id}},{key:"getImageSrc",value:function(){return this.imageSrc}},{key:"setImageSrc",value:function(e){this.imageSrc=e}},{key:"getAuthor",value:function(){return this.author}},{key:"setAuthor",value:function(e){this.author=e}},{key:"getName",value:function(){return this.name}},{key:"setName",value:function(e){this.name=e}},{key:"getYear",value:function(){return this.year}},{key:"setYear",value:function(e){this.year=e}}])&&Y(t.prototype,n),r&&Y(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function z(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var $=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"dataToModel",value:function(e){var t=new G(e.id);return t.setQuestionId(e.questionId),t.setImageSrc(e.imageSrc),t.setName(e.name),t.setAuthor(e.author),t.setYear(e.year),t}},{key:"getAllByQuestionId",value:function(t){return new Promise((function(n){M.getData().then((function(r){var a=r.gameDB.answer.filter((function(e){return e.questionId===t}));n(a.map((function(t){return e.dataToModel(t)})))}))}))}}],(n=null)&&z(t.prototype,n),r&&z(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function F(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function K(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var X=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),K(this,"id",-1),K(this,"answerId",-1),K(this,"questionId",-1),K(this,"thinkingTime",null),K(this,"answerDate",null),this.id=t}var t,n,r;return t=e,(n=[{key:"getId",value:function(){return this.id}},{key:"getQuestionId",value:function(){return this.questionId}},{key:"setQuestionId",value:function(e){this.questionId=e}},{key:"getAnswerId",value:function(){return this.answerId}},{key:"setAnswerId",value:function(e){this.answerId=e}},{key:"getAnswerDate",value:function(){return this.answerDate}},{key:"setAnswerDate",value:function(e){this.answerDate=e}},{key:"getThinkingTime",value:function(){return this.thinkingTime}},{key:"setThinkingTime",value:function(e){this.thinkingTime=e}}])&&F(t.prototype,n),r&&F(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function Z(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ee(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function te(e){return function(e){if(Array.isArray(e))return ne(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return ne(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ne(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ne(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function re(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var ae=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"dataToModel",value:function(e){var t=new X(e.id);return t.setAnswerId(e.answerId),t.setQuestionId(e.questionId),t.setThinkingTime(e.thinkingTime),t.setAnswerDate(e.answerDate),t}},{key:"getByQuestionId",value:function(t){return new Promise((function(n){M.getData().then((function(r){var a=r.gameDB.userAnswer.filter((function(e){return e.questionId===t}));a&&a.length>0&&n(a.map((function(t){return e.dataToModel(t)}))[0]),n(null)}))}))}},{key:"setUserAnswer",value:function(t){return new Promise((function(n){M.getData().then((function(r){var a=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Z(Object(n),!0).forEach((function(t){ee(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Z(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},r),i=e.modelToData(t);e.getByQuestionId(t.getQuestionId()).then((function(e){if(e){i.id=e.getId();var t=a.gameDB.userAnswer.findIndex((function(t){return t.id===e.getId()}));a.gameDB.userAnswer[t]=i}else i.id=function(e){if(!e||0===e.length)return-1;var t=e.map((function(e){return e.id}));return Math.max.apply(Math,te(t))}(a.gameDB.userAnswer)+1,a.gameDB.userAnswer.push(i);n(M.setData(a))}))}))}))}},{key:"modelToData",value:function(e){return{id:e.getId(),questionId:e.getQuestionId(),answerId:e.getAnswerId(),thinkingTime:e.getThinkingTime(),answerDate:e.getAnswerDate()}}}],(n=null)&&re(t.prototype,n),r&&re(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function ie(e){return function(e){if(Array.isArray(e))return oe(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return oe(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return oe(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function oe(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function se(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var ue=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"dataToModel",value:function(e){var t=new R(e.id);t.setNumber(e.number),t.setLevelId(e.levelId),t.setQuestionType(e.questionType),t.setCorrectAnswerId(e.correctAnswerId),t.setImageSrc(e.imageSrc),t.setText(e.text);var n=new Promise((function(n){$.getAllByQuestionId(e.id).then((function(e){n(t.setAnswers(e))}))})),r=new Promise((function(n){ae.getByQuestionId(e.id).then((function(e){n(t.setUserAnswer(e))}))}));return new Promise((function(e){Promise.all([n,r]).then(e(t))}))}},{key:"getAllByLevelId",value:function(t){return new Promise((function(n){M.getData().then((function(r){var a=r.gameDB.question.filter((function(e){return e.levelId===t}));Promise.all(a.map((function(t){return e.dataToModel(t)}))).then((function(e){return n(e)}))}))}))}},{key:"getLastWithAnswerByLevelId",value:function(t){return new Promise((function(n){e.getAllByLevelId(t).then((function(e){var t=e.filter((function(e){return e.getUserAnswer()})),r=t.map((function(e){return e.getNumber()})),a=Math.max.apply(Math,ie(r)),i=t.filter((function(e){return e.getNumber()===a}))[0];n(i)}))}))}}],(n=null)&&se(t.prototype,n),r&&se(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function le(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var ce=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"dataToModel",value:function(e){return new Promise((function(t){var n=new H(e.id);n.setImageSrc(e.imageSrc),n.setText(e.text),n.setIsLocked(e.isLocked),ue.getAllByLevelId(e.id).then((function(e){n.setQuestions(e),t(n)}))}))}},{key:"getAll",value:function(){return new Promise((function(t){M.getData().then((function(n){var r=n.gameDB.level.map((function(t){return e.dataToModel(t)}));Promise.all(r).then((function(e){return t(e)}))}))}))}},{key:"getById",value:function(t){return new Promise((function(n){M.getData().then((function(r){var a=null;(a=r.gameDB.level.filter((function(e){return e.id===parseInt(t,10)})))&&a.length>0&&a.map((function(t){return e.dataToModel(t)}))[0].then((function(e){return n(e)}))}))}))}},{key:"getTestPromise",value:function(e){return new Promise((function(t){setTimeout((function(){console.error("gg"),t("result after ".concat(e))}),e)}))}},{key:"getTestPromiseArray",value:function(){return new Promise((function(t){var n=[e.getTestPromise(2e3),e.getTestPromise(1e3)];Promise.all(n).then((function(e){return t(e)}))}))}}],(n=null)&&le(t.prototype,n),r&&le(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function de(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var he=function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.parentElement=t,this.rootEl=document.createElement("div"),this.rootEl.classList.add("container"),this.sidebar=new l,this.generateSidebarData(),this.page=document.createElement("div"),this.page.classList.add("main-page"),this.topBar=new d,this.topBar.setData({title:"".concat(p.getLocale("levelsTitle"),".")}),this.topBarEl=this.topBar.render(),this.levelsListView=new y,this.scoreView=new C,this.settingsView=new D,this.aboutView=new _,this.currentView=document.createElement("div"),this.page.append(this.topBarEl),this.page.append(this.currentView),this.rootEl.append(this.sidebar.render()),this.sidebar.hide(),this.rootEl.append(this.page),this.sidebar.buttonClose.onclick=function(){n.sidebar.hide()},this.topBar.menuButton.onclick=function(){n.sidebar.show()}}var t,n,r;return t=e,(n=[{key:"generateSidebarData",value:function(e){var t={separatorText:p.getLocale("sidebarMotto"),currentPath:"/main".concat(e),menu:[{text:p.getLocale("levelsTitle"),path:"/main/levels",action:i.setCurrentPath},{text:p.getLocale("scoreTitle"),path:"/main/score",action:i.setCurrentPath},{text:p.getLocale("settingsTitle"),path:"/main/settings",action:i.setCurrentPath},{text:p.getLocale("aboutTitle"),path:"/main/about",action:i.setCurrentPath}],fastLangSw:[{text:"eng",action:function(){p.currentLocale=0,i.setCurrentPath(i.getCurrentPath())}},{text:"ru",action:function(){p.currentLocale=1,i.setCurrentPath(i.getCurrentPath())}}]};this.sidebar.setData(t)}},{key:"rewriteView",value:function(e){this.currentView.innerHTML="",this.currentView.append(e)}},{key:"viewLevels",value:function(){var e=this;ce.getAll().then((function(t){e.levelsListView.setData({levelsList:t})})),this.rewriteView(this.levelsListView.render()),this.topBar.setData({title:"".concat(p.getLocale("levelsTitle"),".")})}},{key:"viewSettings",value:function(){this.rewriteView(this.settingsView.render()),this.topBar.setData({title:"".concat(p.getLocale("settingsTitle"),".")})}},{key:"viewScore",value:function(){var e=this;ce.getAll().then((function(t){return e.scoreView.setData({levelsList:t})})),this.rewriteView(this.scoreView.render()),this.topBar.setData({title:"".concat(p.getLocale("scoreTitle"),".")})}},{key:"viewAbout",value:function(){this.rewriteView(this.aboutView.render()),this.topBar.setData({title:"".concat(p.getLocale("aboutTitle"),".")})}},{key:"resolve",value:function(e){switch(this.parentElement.innerHTML="",this.parentElement.append(this.rootEl),this.generateSidebarData(e),e.slice(1)){case"levels":this.viewLevels();break;case"settings":this.viewSettings();break;case"about":this.viewAbout();break;case"score":this.viewScore()}}}])&&de(t.prototype,n),r&&de(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function fe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var pe=function(){function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.rootEl=document.createElement("div"),this.rootEl.classList.add("overlay"),this.rootEl.classList.add("overlay_blur"),this.buttonSelect=document.createElement("button"),this.buttonSelect.classList.add("variant-popup__button"),this.buttonSelect.classList.add("variant-popup__button_select"),this.buttonSelect.textContent=p.getLocale("gameSelectTitle"),this.buttonCancel=document.createElement("button"),this.buttonCancel.classList.add("variant-popup__button"),this.buttonCancel.classList.add("variant-popup__button_cancel"),this.buttonCancel.textContent=p.getLocale("gameCancelTitle"),this.buttonCancel.onclick=function(){return t.hide()},this.variantButtons=document.createElement("div"),this.variantButtons.classList.add("variant-popup__buttons"),this.variantButtons.append(this.buttonCancel),this.variantButtons.append(this.buttonSelect),this.downloadButton=document.createElement("button"),this.downloadButton.classList.add("variant-popup__download-button")}var t,n,r;return t=e,(n=[{key:"setData",value:function(e){var t=this,n=e.answer,r=e.question,a=e.questionPopup,i=e.startTime,o=document.createElement("div");o.classList.add("variant-popup");var s=document.createElement("div");s.classList.add("variant-popup__image");var u=document.createElement("img");u.src=n.getImageSrc(),u.alt="variant",s.append(u),s.append(this.downloadButton);var l=n.getImageSrc().split("/").reverse()[0];this.downloadButton.onclick=function(){return function(e,t){var n=document.createElement("a");n.setAttribute("href",e),n.setAttribute("download",t),document.body.appendChild(n),n.click(),document.body.removeChild(n)}(n.getImageSrc(),l)},o.append(s),o.append(this.variantButtons),this.rootEl.innerHTML="",this.rootEl.append(o),this.buttonSelect.onclick=function(){t.hide(),a.setData({question:r,answer:n,startTime:i}),a.show()}}},{key:"hide",value:function(){this.rootEl.classList.add("overlay_hidden")}},{key:"show",value:function(){this.rootEl.classList.remove("overlay_hidden")}},{key:"render",value:function(){return this.rootEl}}])&&fe(t.prototype,n),r&&fe(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function ve(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var me=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.rootEl=document.createElement("div"),this.rootEl.classList.add("overlay"),this.rootEl.classList.add("overlay_blur"),this.popupContainer=document.createElement("div"),this.popupContainer.classList.add("question-popup"),this.buttonNext=document.createElement("button"),this.buttonNext.classList.add("question-popup__button"),this.rootEl.append(this.popupContainer)}var t,n,r;return t=e,(n=[{key:"setData",value:function(e){var t,n,r,a=e.answer,i=e.question,o=e.startTime;t=a,n=i,(r=new X(-1)).setAnswerDate((new Date).toISOString()),r.setAnswerId(t.getId()),r.setQuestionId(n.getId()),r.setThinkingTime((new Date).getTime()-o),ae.setUserAnswer(r);var s=document.createElement("div");s.classList.add("question-popup__result"),this.buttonNext.textContent=p.getLocale("gameNextButtonTitle");var u=document.createElement("div");if(u.classList.add("question-popup__result-description"),i.getCorrectAnswerId()===a.getId()){s.innerText=p.getLocale("gameAnswerCorrect");var l=document.createElement("div");l.classList.add("question-popup__desc-pair"),l.innerText=p.getLocale("gamePictureNameTitle");var c=document.createElement("p");c.innerText='"'.concat(a.getName()[p.getLocale("localeName")],'"'),l.append(c);var d=document.createElement("div");d.classList.add("question-popup__desc-pair"),d.innerText=p.getLocale("gameMadeByTitle");var h=document.createElement("p");h.innerText=a.getAuthor()[p.getLocale("localeName")],d.append(h);var f=document.createElement("div");f.classList.add("question-popup__desc-pair"),f.innerText=p.getLocale("gameYearTitle");var v=document.createElement("p");v.innerText=a.getYear(),f.append(v),u.append(l),u.append(d),u.append(f),s.classList.add("question-popup__result_correct")}else s.innerText=p.getLocale("gameAnswerIncorrect"),s.classList.add("question-popup__result_incorrect");this.popupContainer.innerHTML="",this.popupContainer.append(s),this.popupContainer.append(u),this.popupContainer.append(this.buttonNext)}},{key:"hide",value:function(){this.rootEl.classList.add("overlay_hidden")}},{key:"show",value:function(){this.rootEl.classList.remove("overlay_hidden")}},{key:"render",value:function(){return this.rootEl}}])&&ve(t.prototype,n),r&&ve(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function ge(e){return function(e){if(Array.isArray(e))return ye(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return ye(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ye(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ye(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function be(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var we=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.rootEl=document.createElement("div"),this.rootEl.classList.add("question-card")}var t,n,r;return t=e,(n=[{key:"setData",value:function(e){var t,n,r=(new Date).getTime(),a=e.question,o=function(e){for(var t=ge(e),n=t.length-1;n>0;n-=1){var r=Math.floor(Math.random()*(n+1)),a=t[n];t[n]=t[r],t[r]=a}return t};if(a.getQuestionType()===R.QuestionTypes.WhoIs){this.rootEl.classList.add("question-whois");var s=document.createElement("div");s.classList.add("question-card__question");var u=document.createElement("div");u.classList.add("question-card__image");var l=document.createElement("button");l.classList.add("variant-popup__download-button");var c=document.createElement("img");c.src=a.getImageSrc(),c.alt=p.getLocale("gameQuestionType1");var d=document.createElement("div");d.classList.add("question-card__title"),d.innerText=p.getLocale("gameQuestionType1");var h=document.createElement("div");h.classList.add("question-card_answers-grid");var f=a.getImageSrc().split("/").reverse()[0];l.onclick=function(){return function(e,t){var n=document.createElement("a");n.setAttribute("href",e),n.setAttribute("download",t),document.body.appendChild(n),n.click(),document.body.removeChild(n)}(a.getImageSrc(),f)},o((t=a.getAnswers(),n=e,t.map((function(e){var t=n.questionPopup,a=document.createElement("div");return a.classList.add("question-card_answer"),a.innerText=e.getAuthor()[p.getLocale("localeName")],a.onclick=function(){t.setData({answer:e,question:n.question,startTime:r}),t.show()},a})))).forEach((function(e){return h.append(e)})),u.append(c,l),s.append(u),s.append(d),this.rootEl.append(s),this.rootEl.append(h)}else if(a.getQuestionType()===R.QuestionTypes.WhichIs){this.rootEl.classList.add("question-which");var v=document.createElement("div");v.classList.add("question-which_answers-grid");var m=function(e,t){return e.map((function(e){var n=t.variantPopup,a=document.createElement("div");a.classList.add("question-which_answer");var i=document.createElement("img");return i.alt=p.getLocale("gameQuestionType2"),i.src=e.getImageSrc(),a.onclick=function(){n.setData({answer:e,question:t.question,questionPopup:t.questionPopup,startTime:r}),n.show()},a.append(i),a}))}(a.getAnswers(),e);o(m).forEach((function(e){return v.append(e)}));var g=document.createElement("div");g.classList.add("question-which__question");var y=document.createElement("div");y.classList.add("question-which__title");var b=a.getAnswers().filter((function(e){return e.getId()===a.getCorrectAnswerId()}))[0];y.innerHTML="".concat(p.getLocale("gameQuestionType2"),"<b>").concat(b.getAuthor()[p.getLocale("localeName")],"?</b>"),g.append(y),this.rootEl.append(v),this.rootEl.append(g)}e.questionPopup.buttonNext.onclick=function(){if(e.questionPopup.hide(),a.getNumber()<x.getQuestionsPerLevel()){var t="/game/level/".concat(a.getLevelId(),"/question/").concat(parseInt(a.getNumber(),10)+1);i.setCurrentPath(t)}}}},{key:"hide",value:function(){this.rootEl.classList.add("question-card_hidden")}},{key:"setActive",value:function(){this.rootEl.classList.add("question-card_active")}},{key:"render",value:function(){return this.rootEl}}])&&be(t.prototype,n),r&&be(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function Ee(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var ke=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.rootEl=document.createElement("div"),this.rootEl.classList.add("question-cards-container"),this.rootEl.innerText="Questions here"}var t,n,r;return t=e,(n=[{key:"setData",value:function(e){this.rootEl.innerHTML="";var t=new we,n=e.level.getQuestions().filter((function(t){return t.getNumber()===parseInt(e.questionNumber,10)}))[0];t.setData({question:n,variantPopup:e.variantPopup,questionPopup:e.questionPopup}),this.rootEl.appendChild(t.render())}},{key:"hide",value:function(){this.rootEl.classList.remove("game-question-page_hidden")}},{key:"render",value:function(){return this.rootEl}}])&&Ee(t.prototype,n),r&&Ee(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function Le(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Te=function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.parentElement=t,this.rootEl=document.createElement("div"),this.rootEl.classList.add("container"),this.questionCardsContainer=new ke,this.gameQuestionsPage=document.createElement("div"),this.gameQuestionsPage.classList.add("game-question-page"),this.headerContainer=document.createElement("div"),this.headerContainer.classList.add("header-container"),this.topBar=new d,this.topBar.setData({title:"".concat(p.getLocale("levelTitle")," 0"),isSmall:!0}),this.sidebar=new l,this.generateSidebarData(),this.sidebar.hide(),this.variantPopup=new pe,this.variantPopup.hide(),this.questionPopup=new me,this.questionPopup.hide(),this.questionsNumbersList=new w,this.headerContainer.append(this.topBar.render()),this.headerContainer.append(this.questionsNumbersList.render()),this.gameQuestionsPage.append(this.headerContainer),this.gameQuestionsPage.append(this.questionCardsContainer.render()),this.gameQuestionsPage.append(this.variantPopup.render()),this.gameQuestionsPage.append(this.questionPopup.render()),this.rootEl.append(this.sidebar.render()),this.rootEl.append(this.gameQuestionsPage),this.sidebar.buttonClose.onclick=function(){n.sidebar.hide()},this.topBar.menuButton.onclick=function(){n.sidebar.show()}}var t,n,r;return t=e,(n=[{key:"generateSidebarData",value:function(){var e={separatorText:p.getLocale("sidebarMotto"),currentPath:"!current",menu:[{text:"[".concat(p.getLocale("gamePaused"),"]"),path:"!current",action:null},{text:p.getLocale("levelsTitle"),path:"/main/levels",action:i.setCurrentPath}],fastLangSw:[{text:"eng",action:function(){p.currentLocale=0,i.setCurrentPath(i.getCurrentPath())}},{text:"ru",action:function(){p.currentLocale=1,i.setCurrentPath(i.getCurrentPath())}}]};this.sidebar.setData(e)}},{key:"showQuestion",value:function(e,t){t.getIsLocked()||(this.questionsNumbersList.setData({levelModel:t,questionNumber:e}),this.topBar.setData({title:"".concat(p.getLocale("levelTitle")," ").concat(t.getId()),isSmall:!0}),this.questionCardsContainer.setData({level:t,variantPopup:this.variantPopup,questionPopup:this.questionPopup,questionNumber:e}))}},{key:"resolve",value:function(e){var t=this,n=e.slice(1).split("/"),r=Number.parseInt(n[1],10),a=Number.parseInt(n[3],10);"level"===n[0]&&(4===n.length&&"question"===n[2]?ce.getById(r).then((function(e){t.showQuestion(a,e)})):2===n.length&&ue.getLastWithAnswerByLevelId(r).then((function(e){var t=null!=e?e.getNumber():0;t>=10?t=1:t+=1,i.setCurrentPath("/game/level/".concat(r,"/question/").concat(t))}))),this.generateSidebarData(),this.parentElement.innerHTML="",this.parentElement.append(this.rootEl),this.sidebar.hide()}}])&&Le(t.prototype,n),r&&Le(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function Pe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}new(function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.className=t,this.rootEl=document.getElementsByClassName(t)[0],this.userSettings=new n,this.router=new s,this.mainController=new he(this.rootEl),this.gameController=new Te(this.rootEl)}var t,r,a;return t=e,(r=[{key:"run",value:function(){this.router.addRoute("/main",this.mainController),this.router.addRoute("/game",this.gameController),M.isEmpty().then((function(e){e?fetch(x.getDefaultStaticJsonSrcPath()).then((function(e){return e.json()})).then((function(e){M.srcData=e,i.setCurrentPath("/main/levels")})):i.getRealCurrentPath()&&""!==i.getRealCurrentPath()?i.setCurrentPath(i.getRealCurrentPath()):i.setCurrentPath("/main/levels")}))}}])&&Pe(t.prototype,r),a&&Pe(t,a),Object.defineProperty(t,"prototype",{writable:!1}),e}())("app").run()}();